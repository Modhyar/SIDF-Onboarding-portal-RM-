<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>SIDF RM Credit | Onboarding Portal</title>
<link rel="stylesheet" href="styles.css" />
<style>
   /* ===== Login bar (keeps original layout) ===== */
   .auth-bar{
     margin-top: 12px;
     padding: 10px 12px;
     border-radius: 16px;
     border: 1px solid rgba(11,107,79,.14);
     background: rgba(230,244,239,.30);
     display:flex;
     align-items:center;
     justify-content:space-between;
     gap: 10px;
     flex-wrap: wrap;
   }
   .auth-left{
     display:flex;
     align-items:center;
     gap: 10px;
     flex-wrap: wrap;
   }
   .user-pill{
     display:none;
     align-items:center;
     gap:8px;
     padding: 6px 10px;
     border-radius: 999px;
     border: 1px solid rgba(11,107,79,.22);
     background: rgba(230,244,239,.75);
     color:#0b3e30;
     font-weight: 950;
     font-size: 12px;
   }
   .dot{
     width: 10px;
     height: 10px;
     border-radius: 999px;
     background: linear-gradient(135deg, var(--sidf-teal), var(--sidf-green));
   }
   .auth-actions{
     display:flex;
     gap:10px;
     flex-wrap: wrap;
   }
   /* ===== Modal ===== */
   .modal-backdrop{
     position: fixed;
     inset: 0;
     background: rgba(0,0,0,.45);
     display:none;
     align-items:center;
     justify-content:center;
     padding: 18px;
     z-index: 999;
   }
   .modal{
     width: 100%;
     max-width: 520px;
     border-radius: 18px;
     border: 1px solid rgba(0,0,0,.12);
     background:#fff;
     overflow:hidden;
   }
   .modal-head{
     padding: 14px 16px;
     background: rgba(230,244,239,.55);
     border-bottom: 1px solid rgba(0,0,0,.08);
     display:flex;
     align-items:center;
     justify-content:space-between;
     gap: 10px;
   }
   .modal-head b{ color:#0b3e30; }
   .modal-body{ padding: 14px 16px 16px; }
   .tabs{ display:flex; gap:10px; margin-bottom: 12px; }
   .tab{
     border: 1px solid rgba(0,0,0,.10);
     background:#fff;
     padding: 8px 10px;
     border-radius: 12px;
     font-weight: 900;
     color:#1c2430;
     cursor:pointer;
     user-select:none;
   }
   .tab.active{
     border-color: rgba(11,107,79,.30);
     background: rgba(230,244,239,.60);
     color:#0b3e30;
   }
   .field{ margin-top: 10px; }
   .field label{
     display:block;
     font-size: 12px;
     font-weight: 900;
     color:#0b3e30;
     margin-bottom: 6px;
   }
   .field input{
     width:100%;
     padding: 10px 12px;
     border-radius: 12px;
     border: 1px solid rgba(0,0,0,.14);
     outline:none;
   }
   .field input:focus{
     border-color: rgba(11,107,79,.35);
     box-shadow: 0 0 0 2px rgba(11,107,79,.08);
   }
   .modal-actions{
     display:flex;
     gap:10px;
     flex-wrap: wrap;
     margin-top: 14px;
     justify-content:flex-end;
   }
   .error{
     display:none;
     margin-top: 10px;
     padding: 10px 12px;
     border-radius: 14px;
     border: 1px solid rgba(220,38,38,.20);
     background: rgba(220,38,38,.06);
     color:#7f1d1d;
     font-weight: 800;
     font-size: 12px;
   }
</style>
</head>
<script>window.CURRENT_PAGE_ID = "welcome";</script>
<script>
 // 1) Update these filenames to match your project
 const STEPS = [
   { id:"welcome",   title:"Welcome",            sub:"Mandatory video",   href:"index.html",     key:"sidf_done_welcome" },
   { id:"overview",  title:"SIDF Overview",      sub:"Intro + video",     href:"overview.html",  key:"sidf_done_overview" },
   { id:"structure", title:"SIDF Structure",     sub:"Org charts",        href:"structure.html", key:"sidf_done_structure" },
   { id:"role",      title:"RM Role",            sub:"Timeline",          href:"role.html",      key:"sidf_done_role" },
   { id:"lifecycle", title:"Project Lifecycle",  sub:"Process",           href:"lifecycle.html", key:"sidf_done_lifecycle" },
   { id:"financing", title:"Types of Financing", sub:"WC / PF",           href:"financing.html", key:"sidf_done_financing" },
   { id:"modeling",  title:"Financial Modeling", sub:"Requirements",      href:"modeling.html",  key:"sidf_done_modeling" },
   { id:"final",     title:"Final Tips",         sub:"Wrap up",           href:"final.html",     key:"sidf_done_final" }
 ];
 const CURRENT_PAGE_ID = window.CURRENT_PAGE_ID || "";
 // ---- Account system (demo / local only) ----
 const ACCOUNTS_KEY = "sidf_accounts_v1";        // stores { userId: pin }
 const CURRENT_USER_KEY = "sidf_current_user";   // stores current userId
 function loadAccounts(){
   try { return JSON.parse(localStorage.getItem(ACCOUNTS_KEY) || "{}"); }
   catch(e){ return {}; }
 }
 function saveAccounts(obj){ localStorage.setItem(ACCOUNTS_KEY, JSON.stringify(obj)); }
 function getCurrentUser(){ return localStorage.getItem(CURRENT_USER_KEY) || ""; }
 function setCurrentUser(userId){ localStorage.setItem(CURRENT_USER_KEY, userId); }
 function clearCurrentUser(){ localStorage.removeItem(CURRENT_USER_KEY); }
 // Namespaced progress per user
 function scopedKey(key){
   const u = getCurrentUser();
   return u ? `u:${u}:${key}` : `u:guest:${key}`;
 }
 function isDone(key){ return localStorage.getItem(scopedKey(key)) === "true"; }
 function setDone(key){ localStorage.setItem(scopedKey(key), "true"); }
 function renderStepper(){
   const el = document.getElementById("stepper");
   if(!el) return;
   el.innerHTML = "";
   STEPS.forEach((s, idx) => {
     const a = document.createElement("a");
     a.className = "step";
     a.href = s.href;
     const done = isDone(s.key);
     if(done) a.classList.add("completed");
     if(s.id === CURRENT_PAGE_ID) a.classList.add("current");
     a.innerHTML = `
<div class="step-dot">${done ? "âœ“" : (idx+1)}</div>
<div>
<div class="step-title">${s.title}</div>
<div class="step-sub">${s.sub}</div>
</div>
     `;
     el.appendChild(a);
   });
 }
 // Helper: call on video completion
 window.markStepComplete = function(key){
   setDone(key);
   renderStepper();
 };
 // Expose helpers for other scripts
 window.__sidfAuth = {
   getCurrentUser,
   setCurrentUser,
   clearCurrentUser,
   loadAccounts,
   saveAccounts,
   renderStepper,
   isDone,
   setDone,
   scopedKey
 };
 // initial render (will update after DOM loads too)
 document.addEventListener("DOMContentLoaded", renderStepper);
</script>
<body>
<div class="bg"></div>
<main class="shell">
<header class="topbar">
<div class="brand">
<img src="sidf-logo.png" class="sidf-logo" alt="SIDF Logo">
<div class="brand-text">
<div class="brand-title">SIDF</div>
<div class="brand-sub">Relationship Management Â· Credit</div>
</div>
</div>
<div class="chip">Onboarding Portal</div>
<!-- Progress Timeline -->
<nav class="stepper" id="stepper"></nav>
</header>
<section class="card hero">
<div class="hero-left">
<h1>Welcome ðŸ‘‹</h1>
<p class="muted">
         Welcome to the Saudi Industrial Development Fund. This portal helps Co-op students and new RM (Credit) team members to get started.
</p>
<!-- ===== Login bar (added) ===== -->
<div class="auth-bar">
<div class="auth-left">
<div id="userPill" class="user-pill">
<span class="dot"></span>
<span id="userLabel">Logged in</span>
</div>
<span id="authHint" class="muted" style="font-weight:800;">
             Please log in to save your progress.
</span>
</div>
<div class="auth-actions">
<a id="loginBtn" class="btn primary" href="#">Log in / Create account</a>
<a id="logoutBtn" class="btn ghost" href="#" style="display:none;">Log out</a>
</div>
</div>
<div style="max-width:820px; margin:0 auto;">
<video id="welcomeVideo" width="100%" controls
           controlsList="nodownload noplaybackrate"
           disablePictureInPicture
           playsinline
           preload="metadata"
           style="background:#000;"
           oncontextmenu="return false;"
>
<source src="welcome-video.mp4" type="video/mp4">
           Your browser does not support the video tag.
</video>
</div>
<div style="margin-top:10px;">
<div style="display:flex; justify-content:space-between; align-items:center; gap:10px;">
<div class="muted" style="font-weight:800;">Completion</div>
<div id="progressText" class="muted" style="font-weight:900;">0%</div>
</div>
<div style="margin-top:8px; height:10px; border-radius:999px; overflow:hidden; background:rgba(0,0,0,.08); border:1px solid var(--border);">
<div id="progressBar" style="height:100%; width:0%; background:linear-gradient(135deg, var(--sidf-teal), var(--sidf-green));"></div>
</div>
<p id="watchNote" class="muted" style="margin-top:8px;">
           Please watch the full introduction video to proceed. Skipping ahead is disabled.
</p>
</div>
<div class="callout">
<div class="callout-title">What youâ€™ll find here</div>
<ul>
<li>Overview of SIDF</li>
<li>SIDF structure</li>
<li>Role of Credit Relationship Management</li>
<li>SIDF project lifecycle</li>
<li>Types of SIDF financing</li>
<li>Financial Modeling</li>
<li>Final Tips</li>
</ul>
</div>
<div class="actions">
<!-- KEEP ORIGINAL BUTTON, but lock it until login + video completion -->
<a id="enterPortalBtn" class="btn primary" href="#" style="pointer-events:none; opacity:0.5;">
           Enter Portal
</a>
</div>
<p class="tiny muted">
         Tip: You can revisit this portal anytime during your training.
</p>
</div>
<div class="hero-right">
<div class="panel">
<div class="panel-title">RM Credit â€” Starter View</div>
<div class="statgrid">
<div class="stat">
<div class="stat-label">Audience</div>
<div class="stat-value">Co-op / New Joiners</div>
</div>
<div class="stat">
<div class="stat-label">Goal</div>
<div class="stat-value">Fast onboarding</div>
</div>
<div class="stat">
<div class="stat-label">Track</div>
<div class="stat-value">Credit</div>
</div>
<div class="stat">
<div class="stat-label">Format</div>
<div class="stat-value">Step-by-step</div>
</div>
</div>
<div class="divider"></div>
<div class="kv">
<div style="margin-top:12px; border-radius:16px; overflow:hidden; border:1px solid var(--border); background:#fff;">
<img src="welcome-photo.png" alt="SIDF onboarding" style="width:100%; display:block;">
</div>
</div>
</div>
</div>
</section>
<footer class="footer">
<span>Â© <span id="y"></span> SIDF RM Credit Onboarding (internal)</span>
<span>Built for RM Department Â· Credit</span>
</footer>
</main>
<!-- ===== Modal (added) ===== -->
<div id="modalBackdrop" class="modal-backdrop">
<div class="modal">
<div class="modal-head">
<b>Portal Access</b>
<a id="closeModal" class="btn ghost" href="#">Close</a>
</div>
<div class="modal-body">
<div class="tabs">
<div id="tabLogin" class="tab active">Log in</div>
<div id="tabCreate" class="tab">Create account</div>
</div>
<div class="field">
<label for="userId">User ID (Email or Employee ID)</label>
<input id="userId" type="text" placeholder="example@sidf.gov.sa or 12345" />
</div>
<div class="field">
<label for="pin">PIN (4â€“8 digits)</label>
<input id="pin" type="password" inputmode="numeric" placeholder="â€¢â€¢â€¢â€¢" />
</div>
<div id="err" class="error"></div>
<div class="modal-actions">
<a id="modalCancel" class="btn ghost" href="#">Cancel</a>
<a id="modalSubmit" class="btn primary" href="#">Log in</a>
</div>
<p class="muted" style="margin-top:10px; font-size:12px;">
         Note: This demo stores your login locally in your browser (GitHub Pages has no backend).
</p>
</div>
</div>
</div>
<script>
   document.getElementById("y").textContent = new Date().getFullYear();
   /* ===== Auth UI logic ===== */
   const loginBtn = document.getElementById("loginBtn");
   const logoutBtn = document.getElementById("logoutBtn");
   const userPill = document.getElementById("userPill");
   const userLabel = document.getElementById("userLabel");
   const authHint = document.getElementById("authHint");
   const modalBackdrop = document.getElementById("modalBackdrop");
   const closeModal = document.getElementById("closeModal");
   const modalCancel = document.getElementById("modalCancel");
   const modalSubmit = document.getElementById("modalSubmit");
   const tabLogin = document.getElementById("tabLogin");
   const tabCreate = document.getElementById("tabCreate");
   const userIdInput = document.getElementById("userId");
   const pinInput = document.getElementById("pin");
   const err = document.getElementById("err");
   const enterBtn = document.getElementById("enterPortalBtn");
   let mode = "login"; // login/create
   let videoDone = false;
   function openModal(){
     err.style.display = "none";
     err.textContent = "";
     modalBackdrop.style.display = "flex";
     userIdInput.focus();
   }
   function closeModalFn(){
     modalBackdrop.style.display = "none";
     userIdInput.value = "";
     pinInput.value = "";
   }
   function setMode(m){
     mode = m;
     tabLogin.classList.toggle("active", m === "login");
     tabCreate.classList.toggle("active", m === "create");
     modalSubmit.textContent = (m === "login") ? "Log in" : "Create account";
   }
   function showError(msg){
     err.textContent = msg;
     err.style.display = "block";
   }
   function refreshEnterButton(){
     const loggedIn = !!window.__sidfAuth.getCurrentUser();
     if(loggedIn && videoDone){
       enterBtn.style.pointerEvents = "auto";
       enterBtn.style.opacity = "1";
       enterBtn.href = "overview.html";
     } else {
       enterBtn.style.pointerEvents = "none";
       enterBtn.style.opacity = "0.5";
       enterBtn.href = "#";
     }
   }
   function refreshAuthUI(){
     const u = window.__sidfAuth.getCurrentUser();
     if(u){
       userPill.style.display = "inline-flex";
       userLabel.textContent = u;
       authHint.textContent = "Progress will be saved for this account.";
       loginBtn.style.display = "none";
       logoutBtn.style.display = "inline-flex";
     } else {
       userPill.style.display = "none";
       authHint.textContent = "Please log in to save your progress.";
       loginBtn.style.display = "inline-flex";
       logoutBtn.style.display = "none";
     }
     // Re-render stepper in the new user scope
     window.__sidfAuth.renderStepper();
     // Restore video completion for this user
     restoreVideoCompletionIfDone();
     refreshEnterButton();
   }
   function restoreVideoCompletionIfDone(){
     const u = window.__sidfAuth.getCurrentUser();
     if(!u){
       videoDone = false;
       return;
     }
     // Completion is based on the same step key you already use
     videoDone = window.__sidfAuth.isDone("sidf_done_welcome");
   }
   // Buttons / modal events
   loginBtn.addEventListener("click", (e)=>{ e.preventDefault(); openModal(); });
   closeModal.addEventListener("click", (e)=>{ e.preventDefault(); closeModalFn(); });
   modalCancel.addEventListener("click", (e)=>{ e.preventDefault(); closeModalFn(); });
   tabLogin.addEventListener("click", ()=> setMode("login"));
   tabCreate.addEventListener("click", ()=> setMode("create"));
   logoutBtn.addEventListener("click", (e)=>{
     e.preventDefault();
     window.__sidfAuth.clearCurrentUser();
     refreshAuthUI();
   });
   modalSubmit.addEventListener("click", (e)=>{
     e.preventDefault();
     const userId = (userIdInput.value || "").trim();
     const pin = (pinInput.value || "").trim();
     if(!userId) return showError("Please enter a User ID.");
     if(!pin || pin.length < 4 || pin.length > 8) return showError("PIN must be 4â€“8 digits.");
     const accounts = window.__sidfAuth.loadAccounts();
     if(mode === "create"){
       if(accounts[userId]) return showError("Account already exists. Please log in.");
       accounts[userId] = pin;
       window.__sidfAuth.saveAccounts(accounts);
       window.__sidfAuth.setCurrentUser(userId);
       closeModalFn();
       refreshAuthUI();
     } else {
       if(!accounts[userId]) return showError("Account not found. Please create an account.");
       if(accounts[userId] !== pin) return showError("Incorrect PIN.");
       window.__sidfAuth.setCurrentUser(userId);
       closeModalFn();
       refreshAuthUI();
     }
   });
   // Close modal by clicking backdrop
   modalBackdrop.addEventListener("click", (e)=>{ if(e.target === modalBackdrop) closeModalFn(); });
   // Init
   setMode("login");
   refreshAuthUI();
</script>
<script>
   /* ===== Your original video logic, fixed + saved per account ===== */
   const video = document.getElementById("welcomeVideo");
   const bar = document.getElementById("progressBar");
   const txt = document.getElementById("progressText");
   const note = document.getElementById("watchNote");
   let maxWatched = 0;
   let allowSeekBack = true;
   // Restore progress/complete for current user (simple: if completed => 100%)
   function restoreWelcomeState(){
     const u = window.__sidfAuth.getCurrentUser();
     if(!u){
       // guest: reset UI
       maxWatched = 0;
       bar.style.width = "0%";
       txt.textContent = "0%";
       note.textContent = "Please watch the full introduction video to proceed. Skipping ahead is disabled.";
       return;
     }
     if(window.__sidfAuth.isDone("sidf_done_welcome")){
       bar.style.width = "100%";
       txt.textContent = "100%";
       note.textContent = "Completed âœ“";
     } else {
       bar.style.width = "0%";
       txt.textContent = "0%";
       note.textContent = "Please watch the full introduction video to proceed. Skipping ahead is disabled.";
     }
   }
   restoreWelcomeState();
   function updateProgress() {
     const dur = video.duration || 0;
     if (!dur) return;
     // If already completed for this user, keep at 100%
     if(window.__sidfAuth.getCurrentUser() && window.__sidfAuth.isDone("sidf_done_welcome")){
       bar.style.width = "100%";
       txt.textContent = "100%";
       return;
     }
     if (!video.paused && video.currentTime > maxWatched) {
       maxWatched = video.currentTime;
     }
     const pct = Math.min(100, Math.floor((maxWatched / dur) * 100));
     bar.style.width = pct + "%";
     txt.textContent = pct + "%";
   }
   // Prevent seeking forward beyond maxWatched unless already completed
   video.addEventListener("seeking", () => {
     const loggedIn = !!window.__sidfAuth.getCurrentUser();
     const completed = loggedIn && window.__sidfAuth.isDone("sidf_done_welcome");
     if(completed) return;
     if (video.currentTime > maxWatched + 0.25) {
       allowSeekBack = false;
       video.currentTime = maxWatched;
     }
   });
   video.addEventListener("seeked", () => { if (!allowSeekBack) allowSeekBack = true; });
   video.addEventListener("timeupdate", updateProgress);
   video.addEventListener("play", updateProgress);
   video.addEventListener("loadedmetadata", updateProgress);
   video.addEventListener("keydown", (e) => {
     const keys = ["ArrowRight", "ArrowLeft", "End", "Home", "l", "j"];
     if (keys.includes(e.key)) e.preventDefault();
   });
   video.addEventListener("ended", () => {
     // Must be logged in to save completion + unlock portal
     if(!window.__sidfAuth.getCurrentUser()){
       note.textContent = "Please log in to save progress and unlock Enter Portal.";
       return;
     }
     markStepComplete("sidf_done_welcome");
     updateProgress();
     bar.style.width = "100%";
     txt.textContent = "100%";
     note.textContent = "Completed âœ… You can continue.";
     // Inform auth script that video is done (so it unlocks Enter Portal)
     // Simplest approach: re-run UI refresh based on the stored key
     const u = window.__sidfAuth.getCurrentUser();
     if(u){
       // (auth script checks sidf_done_welcome key)
       // Re-render stepper already done by markStepComplete
     }
     // Unlock enter portal button now that we're done
     const enterBtn = document.getElementById("enterPortalBtn");
     enterBtn.style.pointerEvents = "auto";
     enterBtn.style.opacity = "1";
     enterBtn.href = "overview.html";
   });
   // When user changes (login/logout), refresh welcome state by listening to storage changes
   window.addEventListener("storage", restoreWelcomeState);
</script>
</body>
</html>